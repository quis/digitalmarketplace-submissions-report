<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Submissions report</title>
    <link rel='stylesheet' href="/public/styles/c3.css" />
    <style type='text/css'>
      #chart .c3-line {
        stroke-width: 3px;
      }
      #chart .c3-line-suppliers {
        stroke-width: 3px;
      }
      #chart {
        max-height: 100%;
      }
      #chart .c3 text {
        font-size: 19px;
      }
    </style>
  </head>
  <body>



    <script src="//code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="/public/scripts/d3.js"></script>
    <script src="/public/scripts/c3.js"></script>
    <script>

      (function DMrenderChart() {
        $.get(
          "/api",
          function(data) {

            $('#chart').remove();
            $('body').prepend('<div id="chart" />');

            var chart = c3.generate({
              bindto: '#chart',
              data: {
                json: data,
                keys: {
                  x: 'day',
                  value: ['drafts', 'completed', 'suppliers']
                },
                labels: {
                  value: []
                },
                types: {
                  drafts: 'area',
                  completed: 'area',
                  suppliers: 'line'
                },
                groups: [
                  ['drafts', 'completed']
                ],
              },
              axis: {
                x: {
                  type: 'category'
                }
              },
              color: {
                pattern: ['#96c6e2', '#2b8cc4', '#B10E1E']
              },
              size: {
                height: 600
              }
            });

          }
        );
                                // mins secs milliseconds
        setInterval(DMrenderChart, 60 * 60 * 1000);

      }());

    </script>

  </body>
</html>
